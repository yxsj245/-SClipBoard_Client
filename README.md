# 共享剪切板同步工具

基于PyQt5的Windows剪切板同步客户端，支持单向和双向剪切板内容同步。

## 功能特性

- ✅ **单向同步**: 监听本地剪切板变化，自动同步到服务器
- ✅ **双向同步**: 通过WebSocket实时接收服务器内容并更新到本地剪切板
- ✅ **系统托盘**: 支持最小化到系统托盘运行
- ✅ **配置管理**: 灵活的服务器和安全配置
- ✅ **状态监控**: 实时显示连接状态和同步状态
- ✅ **日志记录**: 详细的操作日志和错误信息

## 安装依赖

```bash
pip install -r requirements.txt
```

## 快速开始

### 1. 启动应用程序

```bash
python run.py
```

或者直接运行：

```bash
python main.py
```

### 2. 配置服务器

1. 点击"设置"按钮或切换到"设置"标签页
2. 输入服务器IP地址（例如：192.168.1.100）
3. 配置API端口（默认：3001）和WebSocket端口（默认：3002）
4. 如果服务器启用了安全认证，请配置认证头信息
5. 点击"保存设置"

### 3. 开始同步

- **单向同步**: 点击"开始单向同步"按钮，程序将监听本地剪切板变化并自动上传
- **双向同步**: 点击"开始双向同步"按钮，程序将建立WebSocket连接实现双向同步

## 配置说明

### 服务器配置

- **服务器IP地址**: 剪切板同步服务器的IP地址
- **API端口**: HTTP API服务端口（默认3001）
- **WebSocket端口**: WebSocket服务端口（默认3002）

### 安全配置

如果服务器启用了安全认证，需要配置：

- **认证头名称**: 例如 `X-API-Key`
- **认证头值**: 对应的API密钥

WebSocket连接会自动附加安全参数，格式如下：
```
ws://服务器IP:端口/ws?deviceId=设备ID&authKey=认证头名称&authValue=认证头值
```

### 其他设置

- **开机自启动**: 系统启动时自动运行程序
- **启动时最小化到托盘**: 程序启动后直接最小化到系统托盘
- **剪切板检查间隔**: 检查剪切板变化的时间间隔（毫秒）

## 使用说明

### 系统托盘功能

程序支持最小化到系统托盘运行，托盘菜单包含：

- **显示主窗口**: 恢复主窗口显示
- **开始单向同步**: 快速启动单向同步
- **开始双向同步**: 快速启动双向同步
- **退出**: 完全退出程序

### 状态监控

在"状态"标签页可以查看：

- **连接状态**: 服务器连接状态
- **WebSocket状态**: WebSocket连接状态
- **监听状态**: 剪切板监听状态
- **同步状态**: 双向同步状态
- **统计信息**: 剪切板项目数量和最后同步时间

### 日志查看

在"日志"标签页可以查看：

- 详细的操作日志
- 错误信息和警告
- 同步记录

## 故障排除

### 常见问题

1. **无法连接到服务器**
   - 检查服务器IP地址和端口配置
   - 确认服务器正在运行
   - 检查网络连接和防火墙设置

2. **WebSocket连接失败**
   - 确认WebSocket端口配置正确
   - 检查服务器WebSocket服务是否启动
   - 验证安全配置是否正确

3. **剪切板监听不工作**
   - 检查剪切板检查间隔设置
   - 确认程序有访问剪切板的权限
   - 查看日志获取详细错误信息

### 日志分析

程序会记录详细的操作日志，包括：

- 连接状态变化
- 剪切板内容同步记录
- 错误和异常信息
- WebSocket消息交互

通过查看日志可以快速定位问题。

## 开发说明

### 项目结构

```
├── main.py              # 主程序文件
├── run.py               # 启动脚本
├── requirements.txt     # 依赖包列表
├── config_example.json  # 配置文件示例
├── README.md           # 说明文档
├── 开发.md             # 开发文档
└── fun/                # API函数库
    ├── clipboard_api.py
    ├── websocket_api.py
    ├── clipboard_client.py
    └── ...
```

### 依赖包

- **PyQt5**: GUI框架
- **requests**: HTTP请求库
- **websockets**: WebSocket客户端
- **pyperclip**: 剪切板操作库

## 许可证

本项目采用开源许可证，具体请查看LICENSE文件。

## 贡献

欢迎提交问题报告和功能建议！
